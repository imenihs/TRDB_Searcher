Options +FollowSymLinks
Require all granted

RewriteEngine On
RewriteRule ^$ public/ [L]

# API routing
RewriteRule ^public/api/search$ public/api/index.php [QSA,L]
RewriteRule ^public/api/.*$ public/api/index.php [QSA,L]

# Public assets and SPA
RewriteCond %{REQUEST_URI} !^/TRDB_Searcher/public/
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ public/$1 [L]

<FilesMatch "\.php$">
  SetHandler "proxy:unix:/run/php/php8.4-fpm.sock|fcgi://localhost"
</FilesMatch>
